version: '3.7'
services:
  web:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage
    environment:
      - APP_ENV=development

  mongo-db-1:
    environment:
      - APP_ENV=development
    volumes:
      - ${DEV_LOCAL_MONGO_DB_PATH_NODE1}:/data/db
    command: mongod --replSet $DEV_MONGODB_REPLICA_SET --auth

  elasticsearch-worker-1:
    environment:
      - node.name=elasticsearch-worker-1
      - cluster.name=es-docker-cluster
      - network.publish_host=elasticsearch-worker-1
      - discovery.seed_hosts=elasticsearch-worker-1
      - discovery.type=single-node
    volumes:
      - $PWD/env/elasticsearch/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml
      - ${DEV_ELASTIC_SEARCH_DB_PATH}node1/:/usr/share/elasticsearch/data/
    ports:
      - "127.0.0.1:9200:9200"

  elasticsearch-mongo-connector:
    command: mongo-connector --auto-commit-interval=0 --stdout --admin-username $DEV_MONGO_INITDB_ROOT_USERNAME --password $DEV_MONGO_INITDB_ROOT_PASSWORD -m mongo-db-1:27017 -t http://elasticsearch-worker-1:9200 -d "elastic2_doc_manager" -c ./mongo-connector-config.json

  redis:
    volumes:
      - ${DEV_REDIS_DB_PATH}:/var/lib/redis
      - ${DEV_REDIS_CONFIG_PATH}:/usr/local/etc/redis/redis.conf

  firmware-worker:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage

  firmware-worker-high-1:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage

  fuzzyhash-worker-1:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage

  firmware-worker-default-1:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage

  androguard-worker-1:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage

  androwarn-worker-1:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage

  apkid-worker-1:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage

  exodus-worker-1:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage

  frida-worker-1:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage

  qark-worker-1:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage

  quark_engine-worker-1:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage

  virustotal-worker-1:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage

  super-android-analyzer-worker-1:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage

  apkleaks-worker-1:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage

  libradar-worker-1:
    volumes:
      - ${DEV_LOCAL_STORAGE_PATH}:/var/www/file_store/00_file_storage